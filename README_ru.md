# KeyHunt - BSGS Search [EN](README.md)

KeyHunt — это высокопроизводительный инструмент для поиска приватных ключей Bitcoin с использованием алгоритма Baby-Step Giant-Step (BSGS). Эта версия включает значительные оптимизации для современных процессоров, улучшенное управление памятью и гибкие настройки поиска.

![ket hunt](https://github.com/Slait/Keyhuntbsgs/blob/main/keyhunt.png?raw=true)

## Основные возможности и изменения
- **Более высокая скорость**: По сравнению с оригинальным Keyhunt, Скорость выше на 20-40% для BSGS, Более быстрое создание Bloom фильтра, более быстрая загрузка Bloom фильтра.
- **Алгоритм BSGS**: Эффективная реализация алгоритма для решения задачи дискретного логарифмирования.
- **Bloom Filters**: Использование экономичных по памяти фильтров Блума для хранения предварительно вычисленных таблиц.
- **Параллельная обработка**: 
  - **Параллельная загрузка Bloom-фильтров**: Фильтры загружаются параллельно в несколько потоков, что кардинально сокращает время старта.
  - **Мультипоточность**: По умолчанию используются все доступные ядра процессора для поиска.
- **Оптимизированное хеширование**: 
  - Переход на **XXH64** для чексумм фильтров Блума и внутреннего хеширования, замена медленных функций.
  - Чексумма файлов теперь проверяется через XXH64.
- **Гибкость поиска**:
  - **WIF Маска**: Поиск приватных ключей, соответствующих определенному шаблону WIF (флаг `-w`).
  - **Пользовательские диапазоны**: Возможность задать конкретные шестнадцатеричные (HEX) диапазоны поиска.
  - **Сохранение прогресса**: Прогресс автоматически сохраняется в файл `checked-deep.txt` при использовании режима `-D`, что позволяет продолжать поиск с прерванного места.
- **Вывод в консоль**: Опциональный вывод WIF ключей в консоль (`-wif 1`).
- **Организация файлов**: Фильтры Блума теперь сохраняются в отдельную папку `filters/` с упорядоченными именами.

## Что добавлено:

1.0.4
Что добавлено:

Поправил вывод -wif (1 | 0) для вывода WIF

Поправил ошибку пропусков

Поправил формирование Фильтра для Windows

Ускорил bloom через 64-bit mix

Ускорил формирование bloom

Ускорил математику AVX2

Векторизованная проверка Bloom, FUSE, XOR фильтра

Prefetching для XOR Fuse (Ускорение фильтров)

Huge Pages (Ускорение фильтров)

Ассемблер для функции double

Добавил blocked фильтр -blocked (скорость медленная как у Bloom, но размер компактнее, не рекомендую. Пока самый лучший это FUSE)

Ускорение FUSE на 25 тактов

Внимание: Обязательно пересоздайте фильтры, так как они не подходят от старой версии.

1.0.3
Удалил oldbloom

Добавил сохранение файла пройденного прогресса 1 раз в минуту (файл save.txt).

Добавил XOR и Fuse Фильтры. Выбираются через -x (bloom|xor|fuse).

Оптимизация фильтра XOR FUSE + 10 процентов. Stage 1, 2, 3.

Добавил проверку checked-deep.txt. Если пройденные диапазоны из файла -D deep.txt есть в файле checked-deep.txt, то он их не проверяет.

Добавил очистку папки tmp перед созданием и после создания FUSE и XOR фильтра.


Внимание: Обязательно пересоздайте фильтры, так как они не подходят от старой версии.


## Использование
![ket hunt](https://github.com/Slait/Keyhuntbsgs/blob/main/keyhunt.gif?raw=true)
## Отказ от ответственности
Я создал этот инструмент как универсальный инструмент для решения головоломок. Я рекомендую всем использовать его только для решения головоломок.

Некоторые пользователи просили меня добавить поддержку Ethereum и мини-ключей, и я это сделал. Но еще раз повторяю, я рекомендую использовать эту программу только для решения головоломок.

## Загрузка и сборка
Эта программа была разработана в среде Linux. Если вы используете Windows, я настоятельно рекомендую использовать среду WSL в Windows. Она доступна в магазине Microsoft.

Пожалуйста, установите ее на свою систему.
```bash
git
build-essential
libssl-dev
libgmp-dev
```

В системах на основе Ubuntu выполните следующие команды, чтобы обновить текущую среду и установить инструменты, необходимые для компиляции.

```bash
apt update && apt upgrade
apt install git -y
apt install build-essential -y
apt install libssl-dev -y
apt install libgmp-dev -y
```
Чтобы клонировать репозиторий

git clone https://github.com/Slait/Keyhuntbsgs.git

Не забудьте перейти в каталог keyhunt (но я здесь не для того, чтобы учить вас командам Linux).

cd keyhunt

### Сборка (Build)
Используйте `Makefile` для компиляции. Вы можете указать целевую архитектуру для оптимизации:
```bash
# Автоопределение архитектуры (рекомендуется)
make

# Явное указание архитектуры (например, для AMD EPYC 9654)
make ARCH=znver4
```
Поддерживаемые архитектуры: `native` (по умолчанию)
# AMD:
   znver4        - AMD EPYC 9654, Ryzen 7000 series
   znver3        - Ryzen 5000 series
   znver2        - Ryzen 3000 series

# Intel:
   arrowlake     - Intel Core Ultra 200 series (e.g. 265KF) (Requires GCC 14+)
   raptorlake    - Intel 13th Gen & 14th Gen (Core i9-13900K, i9-14900K) (Requires GCC 13+)
   alderlake     - Intel 12th Gen (Core i9-12900K)
   skylake       - Older Intel CPUs

# Generic:
   native        - Auto-detect host CPU (Best for local compilation)
   x86-64-v3     - Generic modern CPUs (AVX2)
   x86-64-v4     - Generic very modern CPUs (AVX512)

### Обычный BSGS поиск
Запуск стандартного BSGS поиска в диапазоне по умолчанию или случайного старта.
```bash
./keyhunt -m bsgs -t 8 -f test.txt -S -s 10
```
* `-m bsgs`: Установить режим BSGS.
* `-t 8`: Использовать 8 потоков (если не указано, используются все ядра).
* `-f test.txt`: Файл в котором прописаны публичные ключи для поиска
* `-S`: Сохранить bloom фильтр в папку filters
* `-s 10`: Вывод в консоль информацию о поиске, скорости, времени поиска каждые 10 секунд. Если указать -s 0 вывод будет скрыт. Можно указать любое количество секунд.


### Вывод WIF
Включить печать найденных WIF ключей в консоль (по умолчанию выключено/0).
```bash
./keyhunt -m bsgs -f test.txt -S -s 10 -wif 1
```
* `-wif 1`: Вывести в строку информацию Wif ключа

### Поиск по маске WIF
Поиск приватного ключа, который совпадает с частичной строкой WIF (маской). Это генерирует файл `deep.txt` с диапазонами и обрабатывает их.
```bash
./keyhunt -m bsgs -w KwDiBf89QgGbjEhKnhXJuH_LrciVrZi_qYwk________________

Внимание, пока не реализовано смещение. Подходит для поиска последних символов или неизвестных. Программа создает файл deep.txt с диапазонами и обрабатывает их.
```
* `-w <mask_pattern>`: Указать шаблон WIF.

### Пользовательский диапазон
Поиск внутри конкретного шестнадцатеричного диапазона `Start:End`.
```bash
./keyhunt -m bsgs -r 20000000000000000:3ffffffffffffffff -f test.txt -S -s 10
```
* `-r 20000000000000000:3ffffffffffffffff`: Вы можете указать диапазон поиска вручную

### Продолжение поиска (Deep Mode)
Используйте `-D` для обработки диапазонов из файла (по умолчанию `deep.txt` или созданного флагом `-w`). Прогресс отслеживается в `checked-deep.txt`.
```bash
./keyhunt -m bsgs -D deep.txt
```
* `-D deep.txt`: Вы можете указать несколько диапазонов в файле deep.txt после проверки диапазона программа автоматически перейдет к следующему диапазону и пройденный диапазон сохранит в файл `checked-deep.txt`


### Генерация и хранение фильтров
Фильтры Блума генерируются автоматически, если они не существуют. Они сохраняются в директории `filters/` если вы укажите ключ `-S`, чтобы не захламлять рабочую папку.
**Имена файлов**: Файлы фильтров именуются последовательно (`keyhunt_bsgs_1...`, `_2`, и т.д.) для лучшего порядка.

**Примечание**: Время загрузки значительно улучшено благодаря распараллеливанию.

## Аргументы командной строки

| Флаг         | Описание                                                                                   |
|--------------|--------------------------------------------------------------------------------------------|
| `-m bsgs`    | **Обязательно**. Устанавливает режим BSGS.                                                 |
| `-t <n>`     | Количество потоков (по умолчанию: автоопределение всех ядер).                              |
| `-wif <0/1>` | Включить (1) или выключить (0) вывод WIF в консоль.                                        |
| `-w <mask>`  | Поиск с использованием маски WIF.                                                          |
| `-r <s:e>`   | Установить диапазон поиска (HEX формат начало:конец).                                      |
| `-D <file>`  | Запустить в режиме "Deep" используя файл диапазонов (напр. `deep.txt`).                    |
| `-n <val>`   | Установить пользовательское значение N (Всего точек). По умолчанию 0x100000000000          |
| `-k <val>`   | Установить фактор K. Рекомендую использовать значения из таблице ниже                      |
| `-d`         | Включить режим отладки.                                                                    |
| `-x <val>`   | Выбор фильтра fuse (рекомендую), bloom, blocked, xor. Нужно много RAM и время создания     |
| `-S`         | Сохранение фильтра. Большая S Рекомендую использовать всегда                               |
| `-s <n>`     | Вывод подробной информации в секундах. Маленькая s. Рекомендую от 1 до 30                  |

Внимание: Обязательно пересоздайте фильтры, так как они не подходят от старой версии.


Правильные значения n и максимальные k для конкретных битов
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
| FUSE    | XOR     | Bloom   | bits | `-k` (dec) | `-n` (hex)      | Time create FUSE | Time create XOR | Time create Bloom | Speed -t1 FUSE | Speed -t1 XOR | Speed -t1 Bloom |
| ------- | ------- | ------- | ---- | ---------- | --------------- | ---------------- | --------------- | ----------------- | -------------- | ------------- | --------------- |
| 1,1GB   | 1,3GB   | 1,9GB   | 44   | 128        | 0x100000000000  | 0 min 30 sec     | 1 min 3 sec     | 2 min 31 sec      | ~7 Pkeys/s     | ~6 Pkeys/s    | ~4 Pkeys/s      |
| 2,3GB   | 2,6GB   | 3,8GB   | 44   | 256        | 0x100000000000  | 1 min 1 sec      | 2 min 20 sec    | 5 min 46 sec      | ~12 Pkeys/s    | ~11 Pkeys/s   | ~7 Pkeys/s      |
| 4,7GB   | 5,2GB   | 7,6GB   | 44   | 512        | 0x100000000000  | 2 min 29 sec     | 4 min 33 sec    | 13 min 46 sec     | ~22 Pkeys/s    | ~21 Pkeys/s   | ~14 Pkeys/s     |
| 9,5GB   | 10,4GB  | 15,2GB  | 44   | 1024       | 0x100000000000  | 6 min 44 sec     | 10 min 21 sec   | 27 min 40 sec     | ~41 Pkeys/s    | ~39 Pkeys/s   | ~27 Pkeys/s     |
| 19GB    | ~20,8GB | 32 GB   | 44   | 2048       | 0x100000000000  |                  |                 |                   | ~76 Pkeys/s    |               |                 |
|  GB     |  GB     | 64 GB   | 44   | 4096       | 0x100000000000  |                  |                 |                   |                |               |                 |
| 49,9GB  | 50,8 GB | 66 GB   | 44   | 5120       | 0x100000000000  |                  |                 |                   |                |               |                 |
| GB      |  GB     |  GB     | 44   | 6144       | 0x100000000000  |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 128 GB  | 44   | 8192       | 0x100000000000  |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 256 GB  | 46   | 16384      | 0x400000000000  |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 384 GB  | 46   | 24576      | 0x400000000000  |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 512 GB  | 48   | 32768      | 0x1000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 640 GB  | 48   | 40960      | 0x1000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 768 GB  | 48   | 49152      | 0x1000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 896 GB  | 48   | 57344      | 0x1000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1 TB    | 48   | 65536      | 0x1000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1152 GB | 50   | 73728      | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1280 GB | 50   | 81920      | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1408 GB | 50   | 90112      | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1536 GB | 50   | 98304      | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1664 GB | 50   | 106496     | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1792 GB | 50   | 114688     | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 1920 GB | 50   | 122880     | 0x4000000000000 |                  |                 |                   |                |               |                 |
|  GB     |  GB     | 2 TB    | 50   | 131072     | 0x4000000000000 |                  |                 |                   |                |               |                 |

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------















